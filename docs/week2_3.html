<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Splitting – PSYC559: Applied Machine Learning in Psychology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-121a38a6e2c75e451ef209d5f681333d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week2_1.html">Introduction to Machine Learning</a></li><li class="breadcrumb-item"><a href="./week2_3.html">Data Splitting</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PSYC559: Applied Machine Learning in Psychology</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Table of Contents</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic R Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading in Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Describing Data Numerically</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week1_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Describing Data Visually</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Important Terms and Distinctions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem Classes in ML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Splitting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bias and Variance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Feature Engineering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Example Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numeric Feature Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5f.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Categorical Feature Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week2_5g.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflow</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week3_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week4_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regularized Regression</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-splitting-in-machine-learning" id="toc-data-splitting-in-machine-learning" class="nav-link active" data-scroll-target="#data-splitting-in-machine-learning">Data Splitting in Machine Learning</a></li>
  <li><a href="#training-sample" id="toc-training-sample" class="nav-link" data-scroll-target="#training-sample">Training Sample</a></li>
  <li><a href="#validation-sample" id="toc-validation-sample" class="nav-link" data-scroll-target="#validation-sample">Validation Sample</a></li>
  <li><a href="#test-sample" id="toc-test-sample" class="nav-link" data-scroll-target="#test-sample">Test Sample</a></li>
  <li><a href="#hyperparameters-in-the-context-of-data-splitting" id="toc-hyperparameters-in-the-context-of-data-splitting" class="nav-link" data-scroll-target="#hyperparameters-in-the-context-of-data-splitting">(Hyper)parameters in the Context of Data Splitting</a></li>
  <li><a href="#parameters-vs.-hyperparameters" id="toc-parameters-vs.-hyperparameters" class="nav-link" data-scroll-target="#parameters-vs.-hyperparameters">Parameters vs.&nbsp;Hyperparameters</a></li>
  <li><a href="#role-of-parameters-in-data-splitting" id="toc-role-of-parameters-in-data-splitting" class="nav-link" data-scroll-target="#role-of-parameters-in-data-splitting">Role of Parameters in Data Splitting</a></li>
  <li><a href="#example-k-means-clustering" id="toc-example-k-means-clustering" class="nav-link" data-scroll-target="#example-k-means-clustering">Example: <em>k</em>-Means Clustering</a>
  <ul class="collapse">
  <li><a href="#parameters-learned-from-the-data" id="toc-parameters-learned-from-the-data" class="nav-link" data-scroll-target="#parameters-learned-from-the-data">Parameters (learned from the data)</a></li>
  <li><a href="#hyperparameters-set-before-training" id="toc-hyperparameters-set-before-training" class="nav-link" data-scroll-target="#hyperparameters-set-before-training">Hyperparameters (set before training)</a></li>
  </ul></li>
  <li><a href="#benefits-of-data-splitting-in-ml" id="toc-benefits-of-data-splitting-in-ml" class="nav-link" data-scroll-target="#benefits-of-data-splitting-in-ml">Benefits of Data Splitting in ML</a></li>
  <li><a href="#prevents-overfitting-to-the-training-data" id="toc-prevents-overfitting-to-the-training-data" class="nav-link" data-scroll-target="#prevents-overfitting-to-the-training-data">Prevents Overfitting to the Training Data</a></li>
  <li><a href="#simulates-real-world-performance" id="toc-simulates-real-world-performance" class="nav-link" data-scroll-target="#simulates-real-world-performance">Simulates Real-World Performance</a></li>
  <li><a href="#helps-with-model-selection-tuning" id="toc-helps-with-model-selection-tuning" class="nav-link" data-scroll-target="#helps-with-model-selection-tuning">Helps with Model Selection &amp; Tuning</a></li>
  <li><a href="#detects-data-leakage" id="toc-detects-data-leakage" class="nav-link" data-scroll-target="#detects-data-leakage">Detects Data Leakage</a></li>
  <li><a href="#provides-a-fair-benchmark" id="toc-provides-a-fair-benchmark" class="nav-link" data-scroll-target="#provides-a-fair-benchmark">Provides a Fair Benchmark</a></li>
  <li><a href="#data-splitting-in-real-life" id="toc-data-splitting-in-real-life" class="nav-link" data-scroll-target="#data-splitting-in-real-life">Data Splitting in Real Life</a></li>
  <li><a href="#k-folds-cross-validation" id="toc-k-folds-cross-validation" class="nav-link" data-scroll-target="#k-folds-cross-validation">K-Folds Cross-Validation</a></li>
  <li><a href="#motivation-for-cross-validation" id="toc-motivation-for-cross-validation" class="nav-link" data-scroll-target="#motivation-for-cross-validation">Motivation for Cross-Validation</a></li>
  <li><a href="#k-folds" id="toc-k-folds" class="nav-link" data-scroll-target="#k-folds">K-Folds</a></li>
  <li><a href="#k-folds-cross-validation-in-steps" id="toc-k-folds-cross-validation-in-steps" class="nav-link" data-scroll-target="#k-folds-cross-validation-in-steps">K-Folds Cross-Validation in Steps</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./week2_1.html">Introduction to Machine Learning</a></li><li class="breadcrumb-item"><a href="./week2_3.html">Data Splitting</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Data Splitting</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-splitting-in-machine-learning" class="level1" style="color: yellow">
<h1>Data Splitting in Machine Learning</h1>
</section>
<p>Data splitting (e.g., dividing data into <strong>training, validation, and test samples</strong>) is crucial because it protects us from fooling ourselves about how well a model actually performs.</p>
<section id="training-sample" class="level3">
<h3 class="anchored" data-anchor-id="training-sample">Training Sample</h3>
<ul>
<li><p>The subset of examples used to train the learning algorithm. Here we typically estimate the model’s <strong>parameters</strong> in the training sample.</p></li>
<li><p>For example, if we have data from 150 participants, we might keep data from 100 participants (with known depression scores) to train a predictive model.</p></li>
<li><p><strong>Notes</strong>: Spending too much in training won’t allow us to get a good assessment of predictive performance. We may find a model that fits the training data very well, but is not generalizable (<em>overfitting</em>).</p></li>
</ul>
</section>
<section id="validation-sample" class="level3">
<h3 class="anchored" data-anchor-id="validation-sample">Validation Sample</h3>
<ul>
<li><p>Samples used to tune algorithm <strong>hyperparameters</strong> (e.g., regularization strength, number of neurons in a network).</p></li>
<li><p>For example, from our 100 individuals in the training sample, we may split the training data into 4 groups of 25 participants. Each of these will be a validation sample, and allow us to select the optimal model settings or tuning parameters before our final evaluation.</p></li>
</ul>
</section>
<section id="test-sample" class="level3">
<h3 class="anchored" data-anchor-id="test-sample">Test Sample</h3>
<ul>
<li><p>The test Sample used to evaluate model performance, separate from training and validation. The test sample is not made available in the learning stage. Sometimes too much spent in testing won’t allow us to get a good assessment of model parameters.</p></li>
<li><p>For example, for those 50 participants we never looked out may be our test data. The model can now be used to predict depression scores ; predicted scores for the individuals in the test sample. Here we can now compare actual scores to assess accuracy.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/data_split.png" class="img-fluid figure-img"></p>
<figcaption>https://www.statology.org/validation-set-vs-test-set/</figcaption>
</figure>
</div>
</section>
<section id="hyperparameters-in-the-context-of-data-splitting" class="level1" style="color: yellow">
<h1>(Hyper)parameters in the Context of Data Splitting</h1>
</section>
<p>In our discussion of the training and validation samples we introduce the idea of parameters and hyperparameters. The distinction between these terms can often can trip people up, so it’s worth explaining the difference.</p>
<section id="parameters-vs.-hyperparameters" class="level2">
<h2 class="anchored" data-anchor-id="parameters-vs.-hyperparameters">Parameters vs.&nbsp;Hyperparameters</h2>
<ul>
<li><p><strong>Parameters</strong> are values learned automatically (or estimated) from the training data. The model parameters are often the thing we are interested in estimating in a given algorithm.</p></li>
<li><p>For example. the slope of the line in a simple linear regression prediction problem relating amount of treatment (feature) to depression score (target).</p></li>
<li><p><strong>Hyperparameters</strong> are set before training begins, and control how the learning process works. The selection of hyperparameters is often critical to model performance, as in procedures like k-folds cross-validation, playing a critical role in how the model generalizes.</p></li>
<li><p>For example, the the number of clusters used to partition the data</p></li>
</ul>
</section>
<section id="role-of-parameters-in-data-splitting" class="level2">
<h2 class="anchored" data-anchor-id="role-of-parameters-in-data-splitting">Role of Parameters in Data Splitting</h2>
<p>When we split data, each portion plays a distinct role:</p>
<ul>
<li><p><strong>Training set</strong> → Fit the model parameters.<br>
</p></li>
<li><p><strong>Validation set</strong> → Used to compare different hyperparameter choices.<br>
</p></li>
<li><p><strong>Test set</strong> → Used only once, at the very end, to estimate generalization performance.</p>
<p><br>
<strong>Important note</strong>: Hyperparameters should be tuned using the validation set, not the test set. If we adjust hyperparameters based on the test set, we are indirectly training on it and lose the ability to measure real-world performance.</p></li>
</ul>
<hr>
</section>
<section id="example-k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="example-k-means-clustering">Example: <em>k</em>-Means Clustering</h2>
<section id="parameters-learned-from-the-data" class="level3">
<h3 class="anchored" data-anchor-id="parameters-learned-from-the-data">Parameters (learned from the data)</h3>
<ul>
<li><strong>Cluster centroids</strong>: the coordinates of the cluster centers.<br>
</li>
<li>These are <em>calculated by the algorithm</em> during training and adjusted iteratively until convergence.<br>
</li>
<li>You do not set them manually — the algorithm figures them out.</li>
</ul>
</section>
<section id="hyperparameters-set-before-training" class="level3">
<h3 class="anchored" data-anchor-id="hyperparameters-set-before-training">Hyperparameters (set before training)</h3>
<ul>
<li><strong>Number of clusters (<em>k</em>)</strong>: chosen by the user before running the algorithm.<br>
</li>
<li><strong>Initialization method</strong> (e.g., random, k-means++).<br>
</li>
<li><strong>Maximum number of iterations</strong> allowed.<br>
</li>
<li>These control <em>how</em> the algorithm runs, but are not learned from the data itself.</li>
</ul>
<hr>
</section>
</section>
<section id="benefits-of-data-splitting-in-ml" class="level1" style="color: yellow">
<h1>Benefits of Data Splitting in ML</h1>
</section>
<hr>
<section id="prevents-overfitting-to-the-training-data" class="level2">
<h2 class="anchored" data-anchor-id="prevents-overfitting-to-the-training-data">Prevents Overfitting to the Training Data</h2>
<ul>
<li>When a model is trained, it adapts to patterns in the training set.<br>
</li>
<li>If we only check performance on that same data, we might think the model is excellent — but it may just be memorizing instead of generalizing.<br>
</li>
<li>A separate test set lets us see how the model behaves on <em>new, unseen</em> data.</li>
</ul>
<hr>
</section>
<section id="simulates-real-world-performance" class="level2">
<h2 class="anchored" data-anchor-id="simulates-real-world-performance">Simulates Real-World Performance</h2>
<ul>
<li>In real life, the model will be applied to data it hasn’t seen before.<br>
</li>
<li>By holding out a test set, we simulate that scenario, giving us a better sense of expected performance in practice.</li>
</ul>
<hr>
</section>
<section id="helps-with-model-selection-tuning" class="level2">
<h2 class="anchored" data-anchor-id="helps-with-model-selection-tuning">Helps with Model Selection &amp; Tuning</h2>
<ul>
<li>A validation set (or cross-validation) is used to choose hyperparameters (like tree depth, learning rate, regularization strength).<br>
</li>
<li>If we tuned on the test set, we’d essentially be “leaking” information, and performance estimates would be biased upward.<br>
</li>
<li>Proper splitting ensures that the test set remains untouched until the very end.</li>
</ul>
<hr>
</section>
<section id="detects-data-leakage" class="level2">
<h2 class="anchored" data-anchor-id="detects-data-leakage">Detects Data Leakage</h2>
<ul>
<li>Sometimes information from the future or from labels sneaks into the features.<br>
</li>
<li>If this happens, the model might look perfect on the training set but fail on a clean split.<br>
</li>
<li>Data splitting may not actually help data leakage though. When might it help and when might it not?</li>
</ul>
<hr>
</section>
<section id="provides-a-fair-benchmark" class="level2">
<h2 class="anchored" data-anchor-id="provides-a-fair-benchmark">Provides a Fair Benchmark</h2>
<ul>
<li>In research and industry, different models need to be compared on a <em>common, untouched test set</em>.<br>
</li>
<li>Without splitting, comparisons aren’t meaningful, since each model might overfit differently.</li>
</ul>
<hr>
</section>
<section id="data-splitting-in-real-life" class="level1" style="color: yellow">
<h1>Data Splitting in Real Life</h1>
</section>
<p>In groups of 3–4, discuss:</p>
<blockquote class="blockquote">
<p><strong><em>Imagine a real-world scenario that involves learning and evaluation. This can be interpreted loosely, if necessary. Describe the different aspects of the learning and assessment process and how they might corresponds to training, validation, and test sets in the context of machine learning? Why?”</em></strong></p>
</blockquote>
<section id="k-folds-cross-validation" class="level1" style="color: yellow">
<h1>K-Folds Cross-Validation</h1>
</section>
<p>So, what does all this data splitting mean for us in practice? Let’s take a look at one of the more popular data-splitting methods used in practice: K-Folds Cross-Validation</p>
<section id="motivation-for-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="motivation-for-cross-validation">Motivation for Cross-Validation</h3>
<p>When talking about data-splitting we discussed training, validation and test sets. For a moment, let’s take a closer look at the training and validation sets to get a clear idea of what is happening.</p>
<p>Let’s split our available data into two parts:</p>
<ul>
<li><strong>Training Set</strong>: which the model learns from<br>
</li>
<li><strong>Validation Set</strong>: used to check how well the model performs on data it hasn’t seen before</li>
</ul>
<p>This method is simple and useful. It gives us an early warning if our model is overfitting. However, relying on a single holdout split comes with a big drawback: the result can be very unstable.</p>
<p>This idea motivates a better solution: cross-validation, where we avoid putting all our faith in just one split of the data. Instead, we systematically rotate through multiple splits, averaging the results to get a more stable and reliable estimate of model performance.</p>
</section>
<section id="k-folds" class="level3">
<h3 class="anchored" data-anchor-id="k-folds">K-Folds</h3>
<p>One idea is to break up our data into a number of training and validation sets as the image below shows. We can then average the performance across the k folds to get a more stable estimate of the model performance.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cv.png" class="img-fluid figure-img" width="800"></p>
<figcaption>https://bradleyboehmke.github.io/HOML/process.html#splitting</figcaption>
</figure>
</div>
</section>
<section id="k-folds-cross-validation-in-steps" class="level3">
<h3 class="anchored" data-anchor-id="k-folds-cross-validation-in-steps">K-Folds Cross-Validation in Steps</h3>
<p>Sometimes it is helpful to write out the steps of a procedure like this explicitly.</p>
<section id="step-1-split-the-data-into-k-folds" class="level4">
<h4 class="anchored" data-anchor-id="step-1-split-the-data-into-k-folds">Step 1: Split the data into <em>k</em> folds</h4>
<ul>
<li>Shuffle the dataset randomly.<br>
</li>
<li>Divide it into <em>k</em> roughly equal-sized parts, called folds.<br>
</li>
<li>For example, if k =10, we have 10-fold cross-validation, and split the data into 10 parts.</li>
</ul>
</section>
<section id="step-2-train-and-validate-across-folds" class="level4">
<h4 class="anchored" data-anchor-id="step-2-train-and-validate-across-folds">Step 2: Train and validate across folds</h4>
<p>For each fold <em>i</em> from 1 to <em>k</em>:<br>
1. Use fold <em>i</em> as the validation set.<br>
2. Use the remaining <em>k – 1</em> folds as the training set.<br>
3. Train the model on the training set.<br>
4. Evaluate its performance on the validation set.</p>
<p>At the end, we will have <em>k</em> performance scores (one per fold).</p>
</section>
<section id="step-3-average-the-performance" class="level4">
<h4 class="anchored" data-anchor-id="step-3-average-the-performance">Step 3: Average the performance</h4>
<ul>
<li>Compute the average performance across all <em>k</em> folds.<br>
</li>
<li>This gives a more reliable estimate of how well the model generalizes than using a single holdout split.</li>
</ul>
</section>
<section id="step-4-hyperparameter-tuning" class="level4">
<h4 class="anchored" data-anchor-id="step-4-hyperparameter-tuning">Step 4: Hyperparameter tuning</h4>
<p>To tune hyperparameters using cross-validation:<br>
1. Define a grid of candidate hyperparameter values.<br>
2. For each candidate:<br>
- Repeat steps 2-3.<br>
3. Select the hyperparameter value with the best average performance.</p>
</section>
<section id="step-5-retrain-on-the-full-training-set" class="level4">
<h4 class="anchored" data-anchor-id="step-5-retrain-on-the-full-training-set">Step 5: Retrain on the full training set</h4>
<ul>
<li>Once the best hyperparameter is chosen, retrain the model on the entire training dataset (not just folds).<br>
</li>
<li>This ensures the model learns from all available data.</li>
</ul>
</section>
<section id="step-6-evaluate-on-the-holdout-test-set-if-available" class="level4">
<h4 class="anchored" data-anchor-id="step-6-evaluate-on-the-holdout-test-set-if-available">Step 6: Evaluate on the holdout test set (if available)</h4>
<ul>
<li>If you set aside a test set at the very beginning, now is the time to use it.<br>
</li>
<li>This gives an unbiased estimate of how the tuned model will perform on brand-new data.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>